<div class="book-list-container">
  <div class="page-header">
    <div class="header-text">
      <h1>Books</h1>
      <p class="subtitle">Browse our collection of books</p>
    </div>
  </div>

  <div class="search-container">
    <mat-form-field appearance="outline" class="search-field">
      <mat-label>Search books</mat-label>
      <input
        matInput
        [formControl]="searchControl"
        placeholder="Search by title, author, genre..."
      />
      <mat-icon matPrefix>search</mat-icon>
      @if (searchControl.value) {
        <button
          matSuffix
          mat-icon-button
          aria-label="Clear"
          (click)="clearSearch()"
        >
          <mat-icon>close</mat-icon>
        </button>
      }
    </mat-form-field>
  </div>

  @if (loading()) {
    <div class="loading-container">
      <mat-spinner diameter="48"></mat-spinner>
      <p>Loading books...</p>
    </div>
  } @else if (error()) {
    <mat-card class="error-card" appearance="outlined">
      <mat-card-content>
        <div class="error-content">
          <mat-icon class="error-icon">error_outline</mat-icon>
          <p>{{ error() }}</p>
          <button mat-raised-button color="primary" (click)="reload()">
            <mat-icon>refresh</mat-icon>
            Retry
          </button>
        </div>
      </mat-card-content>
    </mat-card>
  } @else if (books().length === 0) {
    <mat-card class="empty-card" appearance="outlined">
      <mat-card-content>
        <div class="empty-content">
          <mat-icon class="empty-icon">menu_book</mat-icon>
          <p>No books found</p>
          @if (searchControl.value) {
            <p class="empty-hint">Try adjusting your search terms</p>
          }
        </div>
      </mat-card-content>
    </mat-card>
  } @else {
    <mat-card appearance="outlined">
      <mat-card-content class="table-card-content">
        <div class="table-container">
          <table mat-table [dataSource]="books()">
            <ng-container matColumnDef="title">
              <th mat-header-cell *matHeaderCellDef>Title</th>
              <td mat-cell *matCellDef="let book">
                <span class="book-title">{{ book.title }}</span>
              </td>
            </ng-container>

            <ng-container matColumnDef="author">
              <th mat-header-cell *matHeaderCellDef>Author</th>
              <td mat-cell *matCellDef="let book">{{ book.author }}</td>
            </ng-container>

            <ng-container matColumnDef="isbn">
              <th mat-header-cell *matHeaderCellDef>ISBN</th>
              <td mat-cell *matCellDef="let book">
                <code class="isbn">{{ book.isbn }}</code>
              </td>
            </ng-container>

            <ng-container matColumnDef="genre">
              <th mat-header-cell *matHeaderCellDef>Genre</th>
              <td mat-cell *matCellDef="let book">
                <mat-chip-set>
                  <mat-chip>{{ book.genre }}</mat-chip>
                </mat-chip-set>
              </td>
            </ng-container>

            <ng-container matColumnDef="publicationYear">
              <th mat-header-cell *matHeaderCellDef>Year</th>
              <td mat-cell *matCellDef="let book">{{ book.publicationYear }}</td>
            </ng-container>

            <ng-container matColumnDef="description">
              <th mat-header-cell *matHeaderCellDef>Description</th>
              <td mat-cell *matCellDef="let book">
                <span [matTooltip]="book.description" matTooltipShowDelay="300">
                  {{ book.description | truncate: 30 }}
                </span>
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
          </table>
        </div>
      </mat-card-content>
    </mat-card>
  }
</div>
